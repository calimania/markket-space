---
import { getCollection } from "astro:content";
import PageLayout from "../layouts/PageLayout.astro";
import SubscribeForm from "../components/subscribe-form";

const storeEntries = await getCollection("store");
const entry = storeEntries?.[0] || {};
const store = {
  documentId: (entry as any)?.documentId || "",
  ...((entry as any)?.data || {}),
};

const title = "Receipt";
const subtitle = "Thanks for your order â€” here is a summary.";
const heroImage = store?.Cover?.url || "";
const heroLqip = (store as any)?.Cover?.formats?.small?.url || "";
import { markket } from "../../markket.config";
import ReceiptComponent from "../components/receipt";
---

<PageLayout
  title={title}
  description={subtitle}
  image={heroImage}
  heroTitle={title}
  heroSubtitle={subtitle}
  heroImage={heroImage}
  heroLqip={heroLqip}
  heroAspect="4/5"
  heroVariant="compact"
  heroSize="small"
>
  <ReceiptComponent api={markket.api_url} client:load />
  <section class="max-w-3xl mx-auto my-12">
    <div class="mx-auto max-w-6xl px-4">
      <h3 class="text-lg font-semibold">Keep in touch</h3>
      <p class="text-sm mt-1 text-muted">
        Join our newsletter for seller tips and updates.
      </p>
    </div>
    <div class="mt-6">
      <div class="mx-auto max-w-7xl px-4">
        <SubscribeForm store={{ documentId: store.documentId }} client:idle />
      </div>
    </div>
  </section>
</PageLayout>

<style>
  .text-muted {
    color: var(--text-muted);
  }
</style>
